<!DOCTYPE html>  <html> <head>   <title>meebo-jquery.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> <script type="text/javascript">   if (window.location.hostname != '6a68.net') { return; }    var _gaq = _gaq || [];   _gaq.push(['_setAccount', 'UA-32602307-1']);   _gaq.push(['_trackPageview']);    (function() {     var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;     ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';     var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);   })();  </script> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="code-equals-data-equals-code.html">                 code-equals-data-equals-code.js               </a>                                           <a class="source" href="frontend-architecture-patterns.html">                 frontend-architecture-patterns.js               </a>                                           <a class="source" href="functional-programming.html">                 functional-programming.js               </a>                                           <a class="source" href="index.html">                 index.js               </a>                                           <a class="source" href="meebo-jquery.html">                 meebo-jquery.js               </a>                                           <a class="source" href="reentrant-exceptions.html">                 reentrant-exceptions.js               </a>                                           <a class="source" href="rsvp.html">                 rsvp.js               </a>                                           <a class="source" href="theres-a-bluebird-in-my-heart.html">                 theres-a-bluebird-in-my-heart.js               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <p>These are some reusable components I put together as part of the
team building meebo's "interest graph" product. In the third and
final version of the product, we switched from YUI 3 to jQuery,
and moved as much logic to the server as possible.</p>

<p>Although the team focused on writing throwaway code, I was able
to find a few long-lived UI components that occurred throughout
the product in slightly-different forms, abstract just enough to
reduce duplication, and add some documentation to codify assumptions.</p>

<p>Here are a few of those components. I haven't modified them
from the production versions, except to replace inline comments
with the multiline style (for docco clarity), and of course other
developers have made (mostly minor) changes: this isn't solely mine.</p>

<p>Note also that the terse one-liners and very, very minimal in-code
comments are the meebo house style, not my personal style. I've
included tooltip code at the bottom of this article as an example of
code written by meebo's longest-tenured JS developer; his personal
style was enforced as the team style.</p>

<p>I downloaded this code from <a href="s4.meebocdn.net/bigben-static/0.38.0/js/base.js">meebo's cdn</a>,
where it will be available until 7/11/12, when meebo.com is shut down.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * dropdowns are swell</span>
<span class="cm"> *</span>
<span class="cm"> * optionally will dynamically fetch contents for you (via data-dropdown-endpoint attr)</span>
<span class="cm"> *</span>
<span class="cm"> * expects markup of the form</span>
<span class="cm"> *    &lt;div class=&quot;header-menu&quot;&gt;</span>
<span class="cm"> *        &lt;div class=&quot;menu&quot; data-dropdown-endpoint=&quot;/api/foo&quot;&gt; Your loading msg here &lt;/div&gt;</span>
<span class="cm"> *    &lt;/div&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * the menu is hidden by default and shown by toggling an &#39;open&#39; class on the header-menu</span>
<span class="cm"> *</span>
<span class="cm"> * todo factor out special-case stuff around notification dropdown</span>
<span class="cm"> */</span>
<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.header-menu&#39;</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">menuTop</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">),</span> <span class="nx">menu</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;.menu&#39;</span><span class="p">);</span>
    <span class="nx">menuTop</span><span class="p">.</span><span class="nx">toggleClass</span><span class="p">(</span><span class="s1">&#39;open&#39;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.header-menu&#39;</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">el</span><span class="p">)</span> <span class="p">{</span> <span class="k">if</span> <span class="p">(</span><span class="nx">menuTop</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="nx">el</span><span class="p">)</span> <span class="p">{</span> <span class="nx">$</span><span class="p">(</span><span class="nx">el</span><span class="p">).</span><span class="nx">removeClass</span><span class="p">(</span><span class="s1">&#39;open&#39;</span><span class="p">)</span> <span class="p">}</span> <span class="p">});</span>
    <span class="cm">/* notification dropdown */</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">menuTop</span><span class="p">.</span><span class="nx">hasClass</span><span class="p">(</span><span class="s1">&#39;.unread-count&#39;</span><span class="p">))</span> <span class="p">{</span> <span class="nx">menuTop</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;.button&#39;</span><span class="p">).</span><span class="nx">toggleClass</span><span class="p">(</span><span class="s1">&#39;down&#39;</span><span class="p">)</span> <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">menuTop</span><span class="p">.</span><span class="nx">hasClass</span><span class="p">(</span><span class="s1">&#39;open&#39;</span><span class="p">))</span> <span class="p">{</span>
        <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">one</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">menuTop</span><span class="p">.</span><span class="nx">removeClass</span><span class="p">(</span><span class="s1">&#39;open&#39;</span><span class="p">);</span>
                <span class="nx">menuTop</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;.button&#39;</span><span class="p">).</span><span class="nx">removeClass</span><span class="p">(</span><span class="s1">&#39;down&#39;</span><span class="p">);</span>
                <span class="cm">/* notification dropdown */</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">menuTop</span><span class="p">.</span><span class="nx">hasClass</span><span class="p">(</span><span class="s1">&#39;unread-count&#39;</span><span class="p">))</span> <span class="p">{</span>
                    <span class="nx">menuTop</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="s1">&#39;empty&#39;</span><span class="p">);</span>
                    <span class="nx">menuTop</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;.count&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
                    <span class="nx">menuTop</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;.button&#39;</span><span class="p">).</span><span class="nx">removeClass</span><span class="p">(</span><span class="s1">&#39;yellow-button&#39;</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">})</span>
        <span class="p">},</span> <span class="mi">0</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">menu</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;dropdown-endpoint&#39;</span><span class="p">))</span> <span class="p">{</span>
        <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
            <span class="nx">url</span><span class="o">:</span> <span class="nx">menu</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;dropdown-endpoint&#39;</span><span class="p">),</span>
            <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;POST&#39;</span><span class="p">,</span>
            <span class="nx">success</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span> <span class="nx">menu</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">html</span><span class="p">)</span> <span class="p">}</span>
        <span class="p">});</span>
    <span class="p">}</span>
<span class="p">});</span>
        

<span class="cm">/*</span>
<span class="cm"> * info-tooltip is a small black tooltip that holds one *short* line of white info text.</span>
<span class="cm"> *</span>
<span class="cm"> * intent:</span>
<span class="cm"> *    clarify the meaning of iconography by providing a short textual hint.</span>
<span class="cm"> *</span>
<span class="cm"> * WARNING: long text is ellipsized.</span>
<span class="cm"> *</span>
<span class="cm"> * usage:</span>
<span class="cm"> *    data-info-tooltip: text to be inserted.</span>
<span class="cm"> *    (optional) data-info-tooltip-position: &#39;above&#39; or &#39;below&#39; (default), specifies tooltip orientation.</span>
<span class="cm"> *</span>
<span class="cm"> * example: </span>
<span class="cm"> *    &lt;div data-info-tooltip=&quot;tooltip contents&quot; data-info-tooltip-position=&quot;above&quot;&gt;</span>
<span class="cm"> *        &lt;span class=&quot;some incomprehensible icon&quot;&gt;&lt;/span&gt;</span>
<span class="cm"> *    &lt;/div&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * todo: remove hide logic duplication. add short mouseout timer. transition in/out smoothly.</span>
<span class="cm"> */</span>
<span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;mouseenter&#39;</span><span class="p">,</span> <span class="s1">&#39;*[data-info-tooltip]&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.info-tooltip&#39;</span><span class="p">).</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span> 
        <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;&lt;div class=&quot;tooltip info-tooltip&quot;&gt;&lt;div class=&quot;contents&quot;&gt;&lt;/div&gt;&lt;div class=&quot;arrow&quot;&gt;&lt;div&gt;&#39;</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;visibility&#39;</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">);</span> 
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">target</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">closest</span><span class="p">(</span><span class="s1">&#39;[data-info-tooltip]&#39;</span><span class="p">),</span>
        <span class="nx">tooltip</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.info-tooltip&#39;</span><span class="p">),</span>
        <span class="nx">arrow</span> <span class="o">=</span> <span class="nx">tooltip</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;.arrow&#39;</span><span class="p">),</span>
        <span class="nx">position</span> <span class="o">=</span> <span class="nx">target</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;info-tooltip-position&#39;</span><span class="p">)</span> <span class="o">||</span> <span class="s1">&#39;below&#39;</span><span class="p">,</span>
        <span class="nx">text</span> <span class="o">=</span> <span class="nx">target</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;info-tooltip&#39;</span><span class="p">),</span>
        <span class="nx">topOffset</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">tooltip</span><span class="p">.</span><span class="nx">is</span><span class="p">(</span><span class="s1">&#39;:visible&#39;</span><span class="p">))</span> <span class="p">{</span> 
        <span class="nx">tooltip</span>
            <span class="p">.</span><span class="nx">removeClass</span><span class="p">(</span><span class="s1">&#39;above below&#39;</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;visibility&#39;</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;contents&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">tooltip</span>
        <span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="nx">position</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;.contents&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="nx">text</span><span class="p">);</span>

    <span class="cm">/* setTimeout so we can accurately measure tooltip&#39;s width */</span>
    <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">topOffset</span> <span class="o">=</span> <span class="nx">position</span> <span class="o">==</span> <span class="s1">&#39;above&#39;</span> <span class="o">?</span> <span class="nx">target</span><span class="p">.</span><span class="nx">offset</span><span class="p">().</span><span class="nx">top</span> <span class="o">-</span> <span class="nx">tooltip</span><span class="p">.</span><span class="nx">outerHeight</span><span class="p">()</span> <span class="o">:</span> <span class="nx">target</span><span class="p">.</span><span class="nx">offset</span><span class="p">().</span><span class="nx">top</span> <span class="o">+</span> <span class="nx">target</span><span class="p">.</span><span class="nx">outerHeight</span><span class="p">();</span>
        <span class="nx">arrow</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="nx">tooltip</span><span class="p">.</span><span class="nx">outerWidth</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="nx">arrow</span><span class="p">.</span><span class="nx">outerWidth</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
        <span class="nx">tooltip</span>
            <span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="nx">topOffset</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="nx">target</span><span class="p">.</span><span class="nx">offset</span><span class="p">().</span><span class="nx">left</span> <span class="o">+</span> <span class="p">(</span><span class="nx">target</span><span class="p">.</span><span class="nx">outerWidth</span><span class="p">()</span> <span class="o">-</span> <span class="nx">tooltip</span><span class="p">.</span><span class="nx">outerWidth</span><span class="p">())</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;visibility&#39;</span><span class="p">,</span> <span class="s1">&#39;visible&#39;</span><span class="p">);</span>
    <span class="p">},</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">}).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;mouseleave&#39;</span><span class="p">,</span> <span class="s1">&#39;[data-info-tooltip]&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.info-tooltip&#39;</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">removeClass</span><span class="p">(</span><span class="s1">&#39;above below&#39;</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;visibility&#39;</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;.contents&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
<span class="p">});</span>

<span class="cm">/*</span>
<span class="cm"> * tabs are swell</span>
<span class="cm"> *</span>
<span class="cm"> * .tab properties:</span>
<span class="cm"> *   - href attribute - selector for tab container. just use an id.</span>
<span class="cm"> *   - data-endpoint attribute (optional) - relative URL to fetch tab pane contents</span>
<span class="cm"> *    - data-cache attribute (optional) - don&#39;t refetch from endpoint if tab pane isn&#39;t empty.</span>
<span class="cm"> *      - intent: improve UI responsiveness on mobile</span>
<span class="cm"> *</span>
<span class="cm"> * markup structure: </span>
<span class="cm"> * - .tab-list should contain only .tab children</span>
<span class="cm"> * - each .tab&#39;s corresponding .tab-pane is identified by an href attribute on the .tab</span>
<span class="cm"> * - the currently-active .tab and .tab-pane have the &#39;active&#39; class</span>
<span class="cm"> *</span>
<span class="cm"> * &lt;div class=&quot;tab-list&quot;&gt;</span>
<span class="cm"> *   &lt;div class=&quot;tab active&quot; href=&quot;#foo&quot; data-endpoint=&quot;/api/bar&quot;&gt;foo&lt;/div&gt;</span>
<span class="cm"> *   &lt;div class=&quot;tab&quot; href=&quot;#bar&quot; data-endpoint=&quot;/api/baz&quot; data-cache=&quot;true&quot;&gt;bar&lt;/div&gt;</span>
<span class="cm"> * &lt;/div&gt;</span>
<span class="cm"> * &lt;div id=&quot;foo&quot; class=&quot;tab-pane active&quot;&gt;&lt;/div&gt;</span>
<span class="cm"> * &lt;div id=&quot;bar&quot; class=&quot;tab-pane&quot;&gt;&lt;/div&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * todo: add css for vertical tabs or horiz/vert pill styles</span>
<span class="cm"> */</span>
<span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">function</span> <span class="nx">switchTab</span><span class="p">(</span><span class="nx">tab</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">tab</span><span class="p">.</span><span class="nx">siblings</span><span class="p">(</span><span class="s1">&#39;.tab&#39;</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">$</span><span class="p">(</span><span class="nx">el</span><span class="p">).</span><span class="nx">removeClass</span><span class="p">(</span><span class="s1">&#39;active&#39;</span><span class="p">);</span>
                <span class="nx">$</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">el</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">)).</span><span class="nx">removeClass</span><span class="p">(</span><span class="s1">&#39;active&#39;</span><span class="p">);</span>
            <span class="p">});</span>
        <span class="nx">tab</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="s1">&#39;active&#39;</span><span class="p">);</span>
        <span class="nx">$</span><span class="p">(</span><span class="nx">tab</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">)).</span><span class="nx">addClass</span><span class="p">(</span><span class="s1">&#39;active&#39;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="s1">&#39;.tab-list .tab&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">tab</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">),</span>
            <span class="nx">pane</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">tab</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">)),</span>
            <span class="nx">loader</span> <span class="o">=</span> <span class="nx">tab</span><span class="p">.</span><span class="nx">siblings</span><span class="p">(</span><span class="s1">&#39;.tab-loader&#39;</span><span class="p">),</span>
            <span class="nx">endpoint</span> <span class="o">=</span> <span class="nx">tab</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;endpoint&#39;</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">pane</span><span class="p">.</span><span class="nx">length</span> <span class="o">||</span> <span class="nx">tab</span><span class="p">.</span><span class="nx">hasClass</span><span class="p">(</span><span class="s1">&#39;active&#39;</span><span class="p">))</span> <span class="p">{</span> <span class="k">return</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">endpoint</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">(</span><span class="nx">pane</span><span class="p">.</span><span class="nx">html</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="nx">tab</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;cache&#39;</span><span class="p">)))</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">loader</span><span class="p">)</span> <span class="p">{</span> <span class="nx">loader</span><span class="p">.</span><span class="nx">fadeIn</span><span class="p">(</span><span class="s1">&#39;fast&#39;</span><span class="p">);</span> <span class="p">}</span>
            <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
                <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;GET&#39;</span><span class="p">,</span>
                <span class="nx">url</span><span class="o">:</span> <span class="nx">endpoint</span><span class="p">,</span>
                <span class="nx">headers</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;Authorization&#39;</span><span class="o">:</span> <span class="s1">&#39;Token token=&#39;</span> <span class="o">+</span> <span class="nx">$</span><span class="p">.</span><span class="nx">cookie</span><span class="p">(</span><span class="s1">&#39;apitoken&#39;</span><span class="p">)},</span>
                <span class="nx">success</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kd">var</span> <span class="nx">html</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">html</span><span class="p">.</span><span class="nx">trim</span><span class="p">()</span> <span class="o">?</span> <span class="nx">$</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">html</span><span class="p">)</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">loader</span><span class="p">)</span> <span class="p">{</span> <span class="nx">loader</span><span class="p">.</span><span class="nx">fadeOut</span><span class="p">(</span><span class="s1">&#39;fast&#39;</span><span class="p">);</span> <span class="p">}</span>
                    <span class="nx">pane</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="nx">html</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">});</span>
        <span class="p">}</span>
        <span class="nx">switchTab</span><span class="p">(</span><span class="nx">tab</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">})();</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>For context, here's a tooltip written by the developer who defined
meebo's team style. Compared to the bulk of the meebo codebase, this
is an extremely generously documented example.</p>

<p>I have modified the code to replace one-line with multi-line comments,
so that docco doesn't split out the original code comments from the code.</p>

<p>This code was downloaded from <a href="s4.meebocdn.net/bigben-static/0.38.0/js/tooltip.js">meebo's cdn</a>,
where it'll be available until meebo shuts down on 7/11/12.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">$</span><span class="p">)</span> <span class="p">{</span>

    <span class="nx">Tooltip</span> <span class="o">=</span> <span class="p">{</span>

        <span class="nx">stuck</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="nx">tooltip</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
        <span class="nx">hoveredElement</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
        <span class="nx">loadingEndpoints</span><span class="o">:</span> <span class="p">{},</span>
        <span class="nx">loadedEndpoints</span><span class="o">:</span> <span class="p">{},</span>
        <span class="cm">/* keep the loaded endpoints in the dom so that their state can</span>
<span class="cm">           be updated */</span>
        <span class="nx">loadedEndpointsContainer</span><span class="o">:</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;&lt;div&gt;&#39;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">).</span><span class="nx">hide</span><span class="p">(),</span>

        <span class="nx">delay</span><span class="o">:</span> <span class="mi">600</span><span class="p">,</span>
        <span class="cm">/* after showing the tooltip if the user hovers to another element</span>
<span class="cm">           with a tooltip in a short period then skip the delay */</span>
        <span class="nx">skipDelay</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="nx">skipDelayTimeout</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>

        <span class="nx">hideTimeout</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>

        <span class="nx">dimensions</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">padding</span><span class="o">:</span> <span class="mi">8</span><span class="p">,</span>
            <span class="nx">arrowBounds</span><span class="o">:</span> <span class="mi">8</span><span class="p">,</span>
            <span class="nx">target</span><span class="o">:</span> <span class="p">{},</span>
            <span class="nx">tooltip</span><span class="o">:</span> <span class="p">{},</span>
            <span class="nx">viewport</span><span class="o">:</span> <span class="p">{}</span>
        <span class="p">},</span>

        <span class="nx">showWithDelay</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">contents</span><span class="p">,</span> <span class="nx">position</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">stuck</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span><span class="p">;</span> <span class="p">}</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">_hide</span><span class="p">();</span>
            <span class="nx">clearTimeout</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">skipDelayTimeout</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">hoveredElement</span> <span class="o">=</span> <span class="nx">el</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">skipDelay</span><span class="p">)</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">show</span><span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">contents</span><span class="p">,</span> <span class="nx">position</span><span class="p">);</span> <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
                <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">hoveredElement</span> <span class="o">!=</span> <span class="nx">el</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span><span class="p">;</span> <span class="p">}</span>
                    <span class="nx">self</span><span class="p">.</span><span class="nx">show</span><span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">contents</span><span class="p">,</span> <span class="nx">position</span><span class="p">);</span>
                <span class="p">},</span> <span class="k">this</span><span class="p">.</span><span class="nx">delay</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">},</span>

        <span class="nx">show</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">contents</span><span class="p">,</span> <span class="nx">position</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">stuck</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span><span class="p">;</span> <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">contents</span> <span class="o">&amp;&amp;</span> <span class="nx">$</span><span class="p">(</span><span class="nx">el</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;tooltip-endpoint&#39;</span><span class="p">))</span> <span class="p">{</span>
                <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_loadEndpoint</span><span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">position</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="k">this</span><span class="p">.</span><span class="nx">_hide</span><span class="p">();</span>
            <span class="nx">clearTimeout</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">skipDelayTimeout</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">skipDelay</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

            <span class="cm">/* create the tooltip */</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">hoveredElement</span> <span class="o">=</span> <span class="nx">el</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">tooltip</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;&lt;div class=&quot;tooltip&quot;&gt;&#39;</span> <span class="o">+</span>
                <span class="s1">&#39;&lt;div class=&quot;arrow&quot;&gt;&lt;div&gt;&lt;/div&gt;&lt;/div&gt;&#39;</span> <span class="o">+</span> 
                <span class="s1">&#39;&lt;div class=&quot;content&quot;&gt;&lt;/div&gt;&#39;</span> <span class="o">+</span>
            <span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">).</span><span class="nx">css</span><span class="p">({</span><span class="nx">visibility</span><span class="o">:</span> <span class="s1">&#39;hidden&#39;</span><span class="p">});</span>
            <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.content&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">tooltip</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">contents</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">tooltip</span><span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">);</span>
            <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">tooltip</span><span class="p">.</span><span class="nx">mouseenter</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">hideTimeout</span><span class="p">);</span>
            <span class="p">}).</span><span class="nx">mouseleave</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">self</span><span class="p">.</span><span class="nx">stuck</span><span class="p">)</span> <span class="p">{</span> <span class="nx">self</span><span class="p">.</span><span class="nx">hide</span><span class="p">();</span> <span class="p">}</span>
            <span class="p">});</span>

            <span class="cm">/* set up the dimensions */</span>
            <span class="kd">var</span> <span class="nx">target</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">el</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">dimensions</span><span class="p">.</span><span class="nx">target</span> <span class="o">=</span> <span class="nx">target</span><span class="p">.</span><span class="nx">offset</span><span class="p">();</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">dimensions</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="nx">target</span><span class="p">.</span><span class="nx">outerWidth</span><span class="p">();</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">dimensions</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="nx">target</span><span class="p">.</span><span class="nx">outerHeight</span><span class="p">();</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">dimensions</span><span class="p">.</span><span class="nx">tooltip</span> <span class="o">=</span> <span class="p">{</span>
                <span class="nx">width</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">tooltip</span><span class="p">.</span><span class="nx">outerWidth</span><span class="p">(),</span>
                <span class="nx">height</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">tooltip</span><span class="p">.</span><span class="nx">outerHeight</span><span class="p">()</span>
            <span class="p">};</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">dimensions</span><span class="p">.</span><span class="nx">viewport</span> <span class="o">=</span> <span class="p">{</span>
                <span class="nx">top</span><span class="o">:</span> <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">scrollTop</span><span class="p">(),</span>
                <span class="nx">left</span><span class="o">:</span> <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">scrollLeft</span><span class="p">(),</span>
                <span class="nx">width</span><span class="o">:</span> <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">width</span><span class="p">(),</span>
                <span class="nx">height</span><span class="o">:</span> <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">height</span><span class="p">()</span>
            <span class="p">};</span>

            <span class="cm">/* work out where to place the tooltip */</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">position</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">position</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;below&#39;</span><span class="p">,</span> <span class="s1">&#39;below-left&#39;</span><span class="p">,</span> <span class="s1">&#39;above&#39;</span><span class="p">,</span> <span class="s1">&#39;above-left&#39;</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="kd">var</span> <span class="nx">positions</span> <span class="o">=</span> <span class="p">(</span><span class="nx">position</span> <span class="k">instanceof</span> <span class="nb">Array</span> <span class="o">?</span> <span class="nx">position</span> <span class="o">:</span> <span class="kc">null</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">positions</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">(</span><span class="nx">position</span> <span class="o">=</span> <span class="nx">positions</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kd">var</span> <span class="nx">offset</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getOffsetForPosition</span><span class="p">(</span><span class="nx">position</span><span class="p">);</span>
                    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_isInBounds</span><span class="p">(</span><span class="nx">offset</span><span class="p">))</span> <span class="p">{</span> <span class="k">break</span><span class="p">;</span> <span class="p">}</span>
                <span class="p">}</span>
                <span class="cm">/* if none are in bounds, check to see if the tooltip target</span>
<span class="cm">                   itself is out of bounds and allow the tooltip to go out of</span>
<span class="cm">                   bounds in the same direction */</span>
                <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">(</span><span class="nx">position</span> <span class="o">=</span> <span class="nx">positions</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kd">var</span> <span class="nx">offset</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getOffsetForPosition</span><span class="p">(</span><span class="nx">position</span><span class="p">);</span>
                    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_isDirectionallyInBounds</span><span class="p">(</span><span class="nx">position</span><span class="p">,</span> <span class="nx">offset</span><span class="p">))</span> <span class="p">{</span> <span class="k">break</span><span class="p">;</span> <span class="p">}</span>
                <span class="p">}</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">position</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">position</span> <span class="o">=</span> <span class="nx">positions</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
                    <span class="nx">offset</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getOffsetForPosition</span><span class="p">(</span><span class="nx">position</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">offset</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getOffsetForPosition</span><span class="p">(</span><span class="nx">position</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="k">this</span><span class="p">.</span><span class="nx">tooltip</span>
                <span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">offset</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="nx">position</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">css</span><span class="p">({</span><span class="nx">visibility</span><span class="o">:</span> <span class="s1">&#39;visible&#39;</span><span class="p">});</span>

            <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
        <span class="p">},</span>

        <span class="nx">hide</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
            <span class="nx">clearTimeout</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">hideTimeout</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">hideTimeout</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="nx">self</span><span class="p">.</span><span class="nx">_hide</span><span class="p">(</span><span class="nx">el</span><span class="p">);</span> <span class="p">},</span> <span class="mi">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
        <span class="p">},</span>

        <span class="nx">_hide</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">clearTimeout</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">hideTimeout</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">el</span> <span class="o">&amp;&amp;</span> <span class="nx">el</span> <span class="o">!=</span> <span class="k">this</span><span class="p">.</span><span class="nx">hoveredElement</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span><span class="p">;</span> <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">tooltip</span><span class="p">)</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">tooltip</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span> <span class="p">}</span>
            <span class="kd">var</span> <span class="nx">endpoint</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">hoveredElement</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;tooltip-endpoint&#39;</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">endpoint</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">loadedEndpointsContainer</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">loadedEndpoints</span><span class="p">[</span><span class="nx">endpoint</span><span class="p">]);</span>
            <span class="p">}</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">tooltip</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">hoveredElement</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">stuck</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
            <span class="nx">clearTimeout</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">skipDelayTimeout</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_onHide</span><span class="p">)</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">_onHide</span><span class="p">();</span> <span class="k">this</span><span class="p">.</span><span class="nx">_onHide</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span> <span class="p">}</span>
            <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">skipDelayTimeout</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                <span class="nx">self</span><span class="p">.</span><span class="nx">skipDelay</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
            <span class="p">},</span> <span class="mi">600</span><span class="p">);</span>
        <span class="p">},</span>

        <span class="nx">stick</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">stuck</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span> <span class="k">return</span> <span class="k">this</span><span class="p">;</span> <span class="p">},</span>

        <span class="nx">onHide</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">_onHide</span> <span class="o">=</span> <span class="nx">callback</span><span class="p">;</span> <span class="k">return</span> <span class="k">this</span><span class="p">;</span> <span class="p">},</span>

        <span class="nx">_loadEndpoint</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">position</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">endpoint</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">el</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;tooltip-endpoint&#39;</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">endpoint</span> <span class="k">in</span> <span class="k">this</span><span class="p">.</span><span class="nx">loadedEndpoints</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">show</span><span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">loadedEndpoints</span><span class="p">[</span><span class="nx">endpoint</span><span class="p">],</span> <span class="nx">position</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">endpoint</span> <span class="k">in</span> <span class="k">this</span><span class="p">.</span><span class="nx">loadingEndpoints</span><span class="p">))</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
                <span class="nx">$</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">endpoint</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kd">var</span> <span class="nx">html</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">tooltip_html</span><span class="p">),</span> <span class="nx">el</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">hoveredElement</span><span class="p">;</span>
                    <span class="nx">self</span><span class="p">.</span><span class="nx">loadedEndpoints</span><span class="p">[</span><span class="nx">endpoint</span><span class="p">]</span> <span class="o">=</span> <span class="nx">html</span><span class="p">;</span>
                    <span class="nx">self</span><span class="p">.</span><span class="nx">loadedEndpointsContainer</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">html</span><span class="p">);</span>
                    <span class="k">delete</span> <span class="nx">self</span><span class="p">.</span><span class="nx">loadingEndpoints</span><span class="p">[</span><span class="nx">endpoint</span><span class="p">];</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">el</span> <span class="o">&amp;&amp;</span> <span class="nx">$</span><span class="p">(</span><span class="nx">el</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;tooltip-endpoint&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="nx">endpoint</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">self</span><span class="p">.</span><span class="nx">show</span><span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">html</span><span class="p">,</span> <span class="nx">position</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">});</span>
                <span class="nx">self</span><span class="p">.</span><span class="nx">loadingEndpoints</span><span class="p">[</span><span class="nx">endpoint</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">},</span>

        <span class="nx">_getOffsetForPosition</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">position</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">ds</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">dimensions</span><span class="p">,</span>
                <span class="nx">y</span> <span class="o">=</span> <span class="nx">ds</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">top</span><span class="p">,</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">ds</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">left</span><span class="p">,</span>
                <span class="nx">h</span> <span class="o">=</span> <span class="nx">ds</span><span class="p">.</span><span class="nx">tooltip</span><span class="p">.</span><span class="nx">height</span><span class="p">,</span> <span class="nx">w</span> <span class="o">=</span> <span class="nx">ds</span><span class="p">.</span><span class="nx">tooltip</span><span class="p">.</span><span class="nx">width</span><span class="p">;</span>

            <span class="kd">var</span> <span class="nx">top</span><span class="p">,</span> <span class="nx">left</span><span class="p">;</span>
            <span class="k">switch</span> <span class="p">(</span><span class="nx">position</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">case</span> <span class="s1">&#39;above&#39;</span><span class="o">:</span> <span class="k">case</span> <span class="s1">&#39;above-left&#39;</span><span class="o">:</span>
                    <span class="nx">top</span> <span class="o">=</span> <span class="nx">y</span> <span class="o">-</span> <span class="nx">h</span> <span class="o">-</span> <span class="nx">ds</span><span class="p">.</span><span class="nx">arrowBounds</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s1">&#39;below&#39;</span><span class="o">:</span> <span class="k">case</span> <span class="s1">&#39;below-left&#39;</span><span class="o">:</span>
                    <span class="nx">top</span> <span class="o">=</span> <span class="nx">y</span> <span class="o">+</span> <span class="nx">ds</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">height</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s1">&#39;left&#39;</span><span class="o">:</span> <span class="k">case</span> <span class="s1">&#39;right&#39;</span><span class="o">:</span> <span class="nx">top</span> <span class="o">=</span> <span class="nx">y</span> <span class="o">-</span> <span class="mi">5</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s1">&#39;left-above&#39;</span><span class="o">:</span> <span class="k">case</span> <span class="s1">&#39;right-above&#39;</span><span class="o">:</span>
                    <span class="nx">top</span> <span class="o">=</span> <span class="nx">y</span> <span class="o">-</span> <span class="nx">h</span> <span class="o">+</span> <span class="mi">20</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">switch</span> <span class="p">(</span><span class="nx">position</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">case</span> <span class="s1">&#39;above&#39;</span><span class="o">:</span> <span class="k">case</span> <span class="s1">&#39;below&#39;</span><span class="o">:</span> <span class="nx">left</span> <span class="o">=</span> <span class="nx">x</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s1">&#39;above-left&#39;</span><span class="o">:</span> <span class="k">case</span> <span class="s1">&#39;below-left&#39;</span><span class="o">:</span>
                    <span class="nx">left</span> <span class="o">=</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">ds</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">width</span> <span class="o">-</span> <span class="nx">w</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s1">&#39;left&#39;</span><span class="o">:</span> <span class="k">case</span> <span class="s1">&#39;left-above&#39;</span><span class="o">:</span>
                    <span class="nx">left</span> <span class="o">=</span> <span class="nx">x</span> <span class="o">-</span> <span class="nx">w</span> <span class="o">-</span> <span class="nx">ds</span><span class="p">.</span><span class="nx">arrowBounds</span><span class="p">;</span> <span class="k">break</span>
                <span class="k">case</span> <span class="s1">&#39;right&#39;</span><span class="o">:</span> <span class="k">case</span> <span class="s1">&#39;right-above&#39;</span><span class="o">:</span>
                    <span class="nx">left</span> <span class="o">=</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">ds</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">width</span><span class="p">;</span> <span class="k">break</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="p">{</span><span class="nx">top</span><span class="o">:</span> <span class="nx">top</span><span class="p">,</span> <span class="nx">left</span><span class="o">:</span> <span class="nx">left</span><span class="p">};</span>
        <span class="p">},</span>

        <span class="cm">/* Note: these methods expect &quot;this&quot; to be the Tooltip */</span>
        <span class="nx">_isInBoundsDirection</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">top</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">offset</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">ds</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">dimensions</span><span class="p">;</span>
                <span class="k">return</span> <span class="nx">offset</span><span class="p">.</span><span class="nx">top</span> <span class="o">-</span> <span class="nx">ds</span><span class="p">.</span><span class="nx">padding</span> <span class="o">&gt;</span> <span class="nx">ds</span><span class="p">.</span><span class="nx">viewport</span><span class="p">.</span><span class="nx">top</span><span class="p">;</span>
            <span class="p">},</span>
            <span class="nx">bottom</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">offset</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">ds</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">dimensions</span><span class="p">;</span>
                <span class="cm">/* because we&#39;re only measuring above/below add arrowBounds</span>
<span class="cm">                   to the height always */</span>
                <span class="k">return</span> <span class="p">(</span><span class="nx">offset</span><span class="p">.</span><span class="nx">top</span> <span class="o">+</span> <span class="nx">ds</span><span class="p">.</span><span class="nx">tooltip</span><span class="p">.</span><span class="nx">height</span> <span class="o">+</span> <span class="nx">ds</span><span class="p">.</span><span class="nx">arrowBounds</span>
                    <span class="o">+</span> <span class="nx">ds</span><span class="p">.</span><span class="nx">padding</span> <span class="o">&lt;</span> <span class="nx">ds</span><span class="p">.</span><span class="nx">viewport</span><span class="p">.</span><span class="nx">top</span> <span class="o">+</span> <span class="nx">ds</span><span class="p">.</span><span class="nx">viewport</span><span class="p">.</span><span class="nx">height</span><span class="p">);</span>
            <span class="p">},</span>
            <span class="nx">left</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">offset</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">ds</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">dimensions</span><span class="p">;</span>
                <span class="k">return</span> <span class="nx">offset</span><span class="p">.</span><span class="nx">left</span> <span class="o">-</span> <span class="nx">ds</span><span class="p">.</span><span class="nx">padding</span> <span class="o">&gt;</span> <span class="nx">ds</span><span class="p">.</span><span class="nx">viewport</span><span class="p">.</span><span class="nx">left</span><span class="p">;</span>
            <span class="p">},</span>
            <span class="nx">right</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">offset</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">ds</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">dimensions</span><span class="p">;</span>
                <span class="k">return</span> <span class="p">(</span><span class="nx">offset</span><span class="p">.</span><span class="nx">left</span> <span class="o">+</span> <span class="nx">ds</span><span class="p">.</span><span class="nx">tooltip</span><span class="p">.</span><span class="nx">width</span> <span class="o">+</span> <span class="nx">ds</span><span class="p">.</span><span class="nx">padding</span>
                    <span class="o">&lt;</span> <span class="nx">ds</span><span class="p">.</span><span class="nx">viewport</span><span class="p">.</span><span class="nx">left</span> <span class="o">+</span> <span class="nx">ds</span><span class="p">.</span><span class="nx">viewport</span><span class="p">.</span><span class="nx">width</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">},</span>

        <span class="nx">_isInBounds</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">offset</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">_isInBoundsDirection</span><span class="p">.</span><span class="nx">left</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">offset</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">_isInBoundsDirection</span><span class="p">.</span><span class="nx">right</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">offset</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">_isInBoundsDirection</span><span class="p">.</span><span class="nx">top</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">offset</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">_isInBoundsDirection</span><span class="p">.</span><span class="nx">bottom</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">offset</span><span class="p">));</span>
        <span class="p">},</span>

        <span class="cm">/* Check to see if the tooltip is in bounds only bounded by the sides</span>
<span class="cm">           with which the tooltip is aligned and only enforcing that bound if</span>
<span class="cm">           the target is in bounds. This allows positioning the tooltip where</span>
<span class="cm">           it would go if the target was fully in bounds but is prevented from</span>
<span class="cm">           doing so because the target is out of bounds. */</span>
        <span class="nx">_isDirectionallyInBounds</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">position</span><span class="p">,</span> <span class="nx">offset</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">ds</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">dimensions</span><span class="p">,</span> <span class="nx">t</span> <span class="o">=</span> <span class="nx">ds</span><span class="p">.</span><span class="nx">target</span><span class="p">,</span> <span class="nx">v</span> <span class="o">=</span> <span class="nx">ds</span><span class="p">.</span><span class="nx">viewport</span><span class="p">;</span>
            <span class="kd">var</span> <span class="nx">vertical</span><span class="p">,</span> <span class="nx">horizontal</span><span class="p">;</span>
            <span class="k">switch</span> <span class="p">(</span><span class="nx">position</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">case</span> <span class="s1">&#39;above&#39;</span><span class="o">:</span> <span class="k">case</span> <span class="s1">&#39;above-left&#39;</span><span class="o">:</span>
                <span class="k">case</span> <span class="s1">&#39;left-above&#39;</span><span class="o">:</span> <span class="k">case</span> <span class="s1">&#39;right-above&#39;</span><span class="o">:</span>
                    <span class="nx">vertical</span> <span class="o">=</span> <span class="p">(</span><span class="nx">t</span><span class="p">.</span><span class="nx">top</span> <span class="o">&gt;</span> <span class="nx">v</span><span class="p">.</span><span class="nx">top</span><span class="p">)</span>
                        <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">_isInBoundsDirection</span><span class="p">.</span><span class="nx">top</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">offset</span><span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s1">&#39;below&#39;</span><span class="o">:</span> <span class="k">case</span> <span class="s1">&#39;below-left&#39;</span><span class="o">:</span>
                <span class="k">case</span> <span class="s1">&#39;left&#39;</span><span class="o">:</span> <span class="k">case</span> <span class="s1">&#39;right&#39;</span><span class="o">:</span>
                    <span class="nx">vertical</span> <span class="o">=</span> <span class="p">(</span><span class="nx">t</span><span class="p">.</span><span class="nx">top</span> <span class="o">+</span> <span class="nx">t</span><span class="p">.</span><span class="nx">height</span> <span class="o">&lt;</span> <span class="nx">v</span><span class="p">.</span><span class="nx">top</span> <span class="o">+</span> <span class="nx">v</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span>
                        <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">_isInBoundsDirection</span><span class="p">.</span><span class="nx">bottom</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">offset</span><span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">switch</span> <span class="p">(</span><span class="nx">position</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">case</span> <span class="s1">&#39;right&#39;</span><span class="o">:</span> <span class="k">case</span> <span class="s1">&#39;right-above&#39;</span><span class="o">:</span>
                <span class="k">case</span> <span class="s1">&#39;below&#39;</span><span class="o">:</span> <span class="k">case</span> <span class="s1">&#39;above&#39;</span><span class="o">:</span>
                    <span class="nx">horizontal</span> <span class="o">=</span> <span class="p">(</span><span class="nx">t</span><span class="p">.</span><span class="nx">left</span> <span class="o">+</span> <span class="nx">t</span><span class="p">.</span><span class="nx">width</span> <span class="o">&lt;</span> <span class="nx">v</span><span class="p">.</span><span class="nx">left</span> <span class="o">+</span> <span class="nx">v</span><span class="p">.</span><span class="nx">width</span><span class="p">)</span>
                        <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">_isInBoundsDirection</span><span class="p">.</span><span class="nx">right</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">offset</span><span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s1">&#39;above-left&#39;</span><span class="o">:</span> <span class="k">case</span> <span class="s1">&#39;below-left&#39;</span><span class="o">:</span>
                <span class="k">case</span> <span class="s1">&#39;left&#39;</span><span class="o">:</span> <span class="k">case</span> <span class="s1">&#39;left-above&#39;</span><span class="o">:</span>
                    <span class="nx">horizontal</span> <span class="o">=</span> <span class="p">(</span><span class="nx">t</span><span class="p">.</span><span class="nx">left</span> <span class="o">&gt;</span> <span class="nx">v</span><span class="p">.</span><span class="nx">left</span><span class="p">)</span>
                        <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">_isInBoundsDirection</span><span class="p">.</span><span class="nx">left</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">offset</span><span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="nx">vertical</span> <span class="o">&amp;&amp;</span> <span class="nx">horizontal</span><span class="p">;</span>
        <span class="p">}</span>

    <span class="p">};</span>

    <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;mouseenter&#39;</span><span class="p">,</span> <span class="s1">&#39;*[data-tooltip-endpoint]&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">Tooltip</span><span class="p">.</span><span class="nx">showWithDelay</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="p">}).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;mouseleave&#39;</span><span class="p">,</span> <span class="s1">&#39;*[data-tooltip-endpoint]&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">Tooltip</span><span class="p">.</span><span class="nx">hide</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="p">});</span>

<span class="p">})(</span><span class="nx">jQuery</span><span class="p">);</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 