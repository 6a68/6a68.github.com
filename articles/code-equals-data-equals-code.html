<!DOCTYPE html>  <html> <head>   <title>code-equals-data-equals-code.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="code-equals-data-equals-code.html">                 code-equals-data-equals-code.js               </a>                                           <a class="source" href="functional-programming.html">                 functional-programming.js               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               code-equals-data-equals-code.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <h2>2. code == data == code (todo)</h2>

<p>JavaScript is the most mutable mainstream language. You can overwrite
or rewrite functions as part of your program. </p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>Transforming source code can be done by converting code to a string,
then doing regular expression transformations on it, or, parse the
source into a series of tokenz, then manipulate those. JavaScript's
syntax is too complex to be handled by regexps. Tokenizing JS is painful
precisely because there's so much syntax.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>Anyway, here's a trivial example to illustrate the basic idea.
In real engineering work, you can use a parser generator to do this robustly.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>Suppose you have some code. Great.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isPos</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">a</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>OK, now let's get the source code. Easy.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isPosSrc</span> <span class="o">=</span> <span class="nx">isPos</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>here's a really simple transformation we can do on this source code</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">function</span> <span class="nx">invert</span><span class="p">(</span><span class="nx">str</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">str</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39;&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">)</span> <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>go ahead and apply it</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isNegSrc</span> <span class="o">=</span> <span class="nx">invert</span><span class="p">(</span><span class="nx">isPosSrc</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>you don't have to use eval here, but it's the shortest, simplest example.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">eval</span><span class="p">(</span><span class="s1">&#39;isNeg = &#39;</span> <span class="o">+</span> <span class="nx">fooInvSrc</span><span class="p">)</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">isNeg</span><span class="p">)</span> <span class="c1">// isNeg = function (a) { return a &lt;= 0 }</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>rather than use eval, we can parse out the body of the function, and
pass that into a function constructor, but it's brittle if we use regexps,
and a whole lot of machinery to tokenize out the names of parameters and
the body of the function.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isNeg</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Function</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;return a &lt;= 0&#39;</span><span class="p">)</span> <span class="c1">// this would be the goal of tokenizing</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>wheeeee!</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 